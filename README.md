# AI Stock Scanner (v3.5.2)

最新の **Gemini 2.5 Flash** と独自の **v1.11 判定ロジック**を組み合わせた、株式スクリーニング＆分析自動化システムです。

## 🌟 プロジェクトの核心

### 1. 「AI × テクニカル」のハイブリッド分析
単なるスクリーニングに留まらず、結果を **Google Gemini 2.5 Flash** へ即座に連携。
* **背景分析**: 出来高急増の理由やセクター動向をAIが推測。
* **レポート配信**: 数値データ＋AIの洞察を組み合わせたレポートをメールで自動配信します。

### 2. インテリジェント・キャッシュ・システム
yfinanceへの負荷を抑え、実行速度を劇的に向上させるキャッシュ機能を搭載。
* **1時間ルール**: 1時間以内の再実行時は `stock_cache.pkl` を活用し、処理を高速化。
* **データ整合性**: 40日分のデータを一括更新することで、株式分割等の影響を排除した正確な判定を維持します。

### 3. 安定した v1.11 判定ロジック
* **▼▼ 【第一段階：実戦モード】 注目候補 ▼▼**
    * 底値圏: 過去25日安値から +15%以内
    * 初動: 当日終値が安値から +10%以上 上昇
    * 出来高: 当日2.0倍、前日1.5倍以上の急増
* **▼▼ 【第二段階：厳格モード】 特選初動候補 ▼▼**
    * 底値圏: 安値から +10%以内
    * 出来高: 2日連続で 2.0倍以上 の急増を記録

---

## 🚀 実行方法

利用シーンに合わせて2つの実行モードを用意しています。

### ① GitHub Actions 版（全自動運用）
クラウド上で毎日定時に実行し、AI分析結果をメールで受け取ります。
* **メインプログラム**: `scanner_ai.py`
* **動作**: 平日 15:15 (JST) に自動起動。

### ② スタンドアロン版（ローカル検証用）
手元のPCで即座に銘柄を抽出し、詳細なファイルを出力します。
* **メインプログラム**: `scanner_standalone.py`
* **出力ファイル**: 
    * `Report_yyyymmdd.csv` (検証用詳細データ)
    * `Report_yyyymmdd.txt` (人間用方針レポート)
* **キャッシュ共有**: `scanner_ai.py` と共通のキャッシュを利用するため、連続実行時は一瞬で完了します。

---

## ⚙️ セットアップ

### 1. GitHub Secrets の設定
GitHub Actions で自動実行するために、リポジトリの `Settings > Secrets and variables > Actions` に以下の **Repository secrets** を登録してください。

| 名前 | 内容 |
| :--- | :--- |
| `GEMINI_API_KEY` | Google AI Studio で発行した Gemini 2.5 Flash 用APIキー |
| `MAIL_ADDRESS` | 送信元Gmailアドレス |
| `MAIL_PASSWORD` | Gmailの「アプリパスワード」 |
| `TO_ADDRESS` | レポートを受け取るメールアドレス（カンマ区切りで複数可） |

### 2. ローカル環境の設定
ローカル実行（スタンドアロン版）を行う場合は、`.env` ファイルを作成し、上記と同じ項目を設定してください。
※`.gitignore` により、`.env` や `.pkl` ファイルは GitHub には公開されません。

---

## 🛡️ 安全性と安定性
* **API BAN対策**: `REQUEST_SLEEP` による適切なウェイト調整とキャッシュ機能により、yfinance への過度なアクセスを防止。
* **最新モデル固定**: Gemini API は最新安定版の `gemini-2.5-flash` に固定されており、高精度な解析を維持します。

🛠 技術スタック
Language: Python 3.10+

AI Model: Gemini 2.5 Flash (google-genai)

Data Source: yfinance

Infrastructure: GitHub Actions
