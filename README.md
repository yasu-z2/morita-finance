# 株価選別・AI分析システム (v3.3.0)

東証プライム銘柄を対象に、過去25日間の「底練り」期間を経て、出来高急増とともに力強く反発を開始した「初動銘柄」を自動抽出するシステムです。
Gemini 2.5 Flashによる市場分析を加え、日本時間で毎日レポートをメール配信します。

## 抽出ロジックの定義

本システムは、スタンドアロン版（v1.11）の安定した判定ロジックをベースに、調整案を反映した二段階選別を採用しています。

### 1. 第一段階：注目候補 (Stage 1)
- **底値圏の確認**: 5日前までの終値すべてが、過去25日間の最安値から **+15%以内** であること（十分に底を固めているかを確認）。
- **初動の確認**: 本日の終値が、過去25日間の最安値から **+10%以上** 上昇していること（底からの脱出を確認）。
- **出来高急増**: 本日の出来高が平均の **2.0倍以上**、かつ前日の出来高が平均の **1.5倍以上** であること。

### 2. 第二段階：特選初動候補 (Stage 2)
第一段階を通過した銘柄の中から、さらに以下の厳格な条件を満たすものを選別します。
- **より深い底値圏**: 過去のレンジが安値から **+10%以内** であること。
- **圧倒的な出来高**: 当日・前日ともに **2.0倍以上** の爆発的な商いを記録していること。

## 主な機能

- **高精度スキャン**: `yfinance` を用いて東証プライム全銘柄をリアルタイムに解析。
- **AI分析レポート**: 最新モデル `gemini-2.5-flash` が、抽出された銘柄のチャート背景や今後の展望を簡潔に解説。
- **統計情報の送信**: 該当銘柄が0件の場合でも、どの判定フェーズで何銘柄が残ったかの統計を送信するため、システムの稼働状況が常に把握可能。
- **JST完全対応**: 実行日時およびレポート内の表記を日本標準時（JST）で統一。

## セットアップ

### GitHub Secrets の設定
以下の環境変数を GitHub リポジトリの `Settings > Secrets and variables > Actions` に登録してください。

| 変数名 | 内容 |
| :--- | :--- |
| `GEMINI_API_KEY` | Google AI Studio から発行されたAPIキー |
| `MAIL_ADDRESS` | 送信元となるGmailアドレス |
| `MAIL_PASSWORD` | Gmailの「アプリパスワード」 |
| `TO_ADDRESS` | 送信先のメールアドレス（カンマ区切りで複数指定可） |

## バージョン履歴
- **v3.3.0**: スタンドアロン版の「過去レンジ判定（5日前まで）」ロジックを統合。初動判定の基準を「25日安値」に変更し、精度を大幅に向上。
- **v3.2.8**: メール表題の固定およびJST（日本時間）表示に対応。
- **v3.2.7**: 該当なし時の統計メール送信機能を追加。Gemini 2.5 Flash モデルを採用。