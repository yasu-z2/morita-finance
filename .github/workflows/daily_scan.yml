name: Stock Scanner STEP1

on:
  schedule:
    # 日本時間 20:15 (UTC 11:15) に毎日実行
    - cron: '15 11 * * *'
  workflow_dispatch: # GitHubのブラウザ上から「Run workflow」ボタンで手動実行を可能にする

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          # STEP1では最低限必要なライブラリのみインストール
          pip install pandas yfinance

      - name: Run STEP1 Script
        env:
          # GitHubのリポジトリ設定 (Settings > Secrets) で登録した値を環境変数にセット
          MAIL_ADDRESS: ${{ secrets.MAIL_ADDRESS }}
          MAIL_PASSWORD: ${{ secrets.MAIL_PASSWORD }}
          TO_ADDRESS: ${{ secrets.TO_ADDRESS }}
        run: python scanner_ai.py